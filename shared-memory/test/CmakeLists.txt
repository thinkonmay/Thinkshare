
find_package(PkgConfig REQUIRED)

project(test C)
if (MINGW)
set(CMAKE_PREFIX_PATH "C:\\gstreamer\\1.0\\mingw_x86")
elseif(MSVC)
set(CMAKE_PREFIX_PATH "C:\\gstreamer\\1.0\\msvc_x86_64")
endif()

find_package(PkgConfig REQUIRED)

pkg_check_modules(GLIB REQUIRED glib-2.0)
pkg_check_modules(GIO REQUIRED gio-2.0)
pkg_check_modules(GOBJECT REQUIRED gobject-2.0)



add_executable(TEST_MASTER test-master.c)
add_executable(TEST_SLAVE test-slave.c)



target_include_directories(TEST_SLAVE PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include 
${GLIB_INCLUDE_DIRS} 
${GIO_INCLUDE_DIRS} 
${GOBJECT_INCLUDE_DIRS})

target_include_directories(TEST_MASTER PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include
${GLIB_INCLUDE_DIRS} 
${GIO_INCLUDE_DIRS} 
${GOBJECT_INCLUDE_DIRS})


target_link_libraries(TEST_MASTER PUBLIC 
${CMAKE_CURRENT_SOURCE_DIR})
target_link_libraries(TEST_SLAVE PUBLIC 
${CMAKE_CURRENT_SOURCE_DIR})


target_link_libraries(TEST_MASTER PUBLIC 
shared-memory.lib) 

target_link_libraries(TEST_SLAVE PUBLIC 
shared-memory.lib) 

